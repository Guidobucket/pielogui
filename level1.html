<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="level1.css">
</head>

<body background="Deserto.jpg">
    <div class="deserto">
        <marquee behavior="" direction="right"> <img src="Deserto.jpg" alt=""></marquee>
    </div>
    <div class="liv1">   <img src="liv 1.png.crdownload" alt=""></div>

    <div class="character">
        <img src="character.png" width="100">
    </div>

    <div class="cammello">
        <img src="cammello.PNG" class="w-100">
    </div>

    <!-- <div class="cammello2">
        <img src="cammello2.PNG"  class="w-100">
    </div> -->

    <script>
        // Valorizing variables
        const charEl = document.querySelector('.character')
        let jumping = false;

        const camelEl1 = document.querySelector('.cammello')
        let walking1 = false


        // detecting key events
        document.onkeydown = (e) => {
            console.log(e)
            if (e.code == "Space" && jumping == false) {
                jumping = true
                charEl.classList.add('jump')
                setTimeout(() => {
                    charEl.classList.remove('jump')
                    jumping = false
                }, 2200)
            }
        }

        // interval management
        setInterval(() => {
            const random1 = Math.random()
            console.log(random1)
            if (random1 < 0.8 && walking1 == false) {
                walking1 = true
                camelEl1.classList.add('walking')
                setTimeout(() => {
                    camelEl1.classList.remove('walking')
                    walking1 = false
                }, 4000)

            }

        }, 500)



        // detect collision
        //TODO
        setInterval(() => {
            // check if camelEl1 is in the same position of charEl
            console.log("checking")
            if (isCollide(camelEl1, charEl)) {
                alert("you die")
                location.reload()
            }
        }, 50)


        // Finish of the level

        setTimeout(() => {   
            alert("You won")
            location.href="katzin1.html"
        }, 60 * 1000)
   

        function isCollide(a, b) {
            var aRect = a.getBoundingClientRect();
            var bRect = b.getBoundingClientRect();

            return !(
                ((aRect.top + aRect.height) < (bRect.top)) ||
                (aRect.top > (bRect.top + bRect.height)) ||
                ((aRect.left + aRect.width) < bRect.left) ||
                (aRect.left > (bRect.left + bRect.width))
            );
        }
    </script>

</body>

</html>